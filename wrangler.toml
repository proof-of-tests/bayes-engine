name = "bayes-engine"
main = "result/worker/worker.js"
compatibility_date = "2024-10-01"

[build]
command = "nix build .#webapp"

# Serve static assets (HTML, CSS, WASM) from the assets directory
# CloudFlare Workers will automatically serve these files
[assets]
directory = "result/assets"

# Hyperdrive database binding for Postgres connectivity
# To set up:
# 1. Create Hyperdrive configuration: wrangler hyperdrive create bayes-db --connection-string="<your-postgres-connection-string>"
# 2. Update the 'id' below with the Hyperdrive ID from step 1
[[hyperdrive]]
binding = "DB"
id = "your-hyperdrive-id-here"

# E2E testing environment - uses pre-compiled files without running build
[env.e2e]
# No build command - assumes result/ directory already exists with compiled files
